{"ast":null,"code":"import { db } from '@/firebase';\nimport { collection, addDoc } from 'firebase/firestore';\nimport axios from 'axios';\nexport default {\n  data() {\n    return {\n      nom: '',\n      numero: '',\n      heure: '',\n      personnes: ''\n    };\n  },\n  methods: {\n    submitReservation() {\n      addDoc(collection(db, 'reservations'), {\n        nom: this.nom,\n        numero: this.numero,\n        heure: this.heure,\n        personnes: this.personnes\n      }).then(docRef => {\n        // Succès de l'enregistrement, récupérez l'ID du document ajouté\n        const reservationId = docRef.id;\n\n        // Envoi du message texte à l'aide de Firebase Cloud Messaging\n        const message = `Nouvelle réservation - ID: ${reservationId}, Nom: ${this.nom}, Heure: ${this.heure}, Personnes: ${this.personnes}`;\n        this.sendSmsMessage('+33671783492', message); // Remplacez '+33671783492' par le numéro de téléphone du destinataire\n\n        // Réinitialisation des valeurs du formulaire\n        this.nom = '';\n        this.numero = '';\n        this.heure = '';\n        this.personnes = '';\n        console.log('Réservation enregistrée avec succès dans Firestore!');\n      }).catch(error => {\n        console.error('Erreur lors de l\\'enregistrement de la réservation:', error);\n      });\n    },\n    sendSmsMessage(phoneNumber, message) {\n      const serverKey = 'AAAAUTx6cRc:APA91bFEdArfClBrNz8ALQe6XFamZ8xaZiVzwoJJ3YYLv9pCMUKQ81odWF3GKvhuJTQBwTO3m_Wwit0ACdLEPiy7SzNOH9kMkLzjbqj3OuHyDJrKuJmy4h-6G2e7CrcGf5RBzqfD_N7T'; // Remplacez par votre clé de serveur FCM\n\n      const requestData = {\n        message: {\n          token: phoneNumber,\n          notification: {\n            body: message,\n            title: 'Nouvelle réservation'\n          },\n          data: {\n            phone_number: phoneNumber,\n            message: message\n          }\n        }\n      };\n      axios.post('https://fcm.googleapis.com/fcm/send', requestData, {\n        headers: {\n          Authorization: `Bearer ${serverKey}`,\n          'Content-Type': 'application/json'\n        }\n      }).then(response => {\n        console.log('Message sent successfully:', response.data);\n      }).catch(error => {\n        console.error('Failed to send message:', error);\n      });\n    }\n  }\n};","map":{"version":3,"names":["db","collection","addDoc","axios","data","nom","numero","heure","personnes","methods","submitReservation","then","docRef","reservationId","id","message","sendSmsMessage","console","log","catch","error","phoneNumber","serverKey","requestData","token","notification","body","title","phone_number","post","headers","Authorization","response"],"sources":["/home/emile/Documents/Epitech/3rd year/INTERNSHIP/tem/src/components/FormulaireReservation.vue"],"sourcesContent":["<template>\n  <div class=\"container mx-auto\">\n    <h1 class=\"text-2xl font-bold mb-4\">Formulaire de réservation de table</h1>\n    <form @submit.prevent=\"submitReservation\">\n      <div class=\"mb-4\">\n        <label class=\"block text-gray-700 font-bold mb-2\" for=\"nom\">\n          Nom de la réservation :\n        </label>\n        <input v-model=\"nom\"\n          class=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n          id=\"nom\" type=\"text\" placeholder=\"Entrez le nom de la réservation\" required />\n      </div>\n      <div class=\"mb-4\">\n        <label class=\"block text-gray-700 font-bold mb-2\" for=\"nom\">\n          Numéro de téléphone :\n        </label>\n        <input v-model=\"numero\"\n          class=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n          id=\"number\" type=\"tel\" pattern=\"[0-9]{2}-[0-9]{2}-[0-9]{2}-[0-9]{2}-[0-9]{2}\"\n          placeholder=\"Exemple xx-xx-xx-xx-xx\" required />\n      </div>\n      <div class=\"mb-4\">\n        <label class=\"block text-gray-700 font-bold mb-2\" for=\"heure\">\n          Heure de réservation :\n        </label>\n        <input v-model=\"heure\"\n          class=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n          id=\"heure\" type=\"text\" pattern=\"[0-9]{2}:[0-9]{2}\" placeholder=\"Exemple xx:xx\" required />\n      </div>\n      <div class=\"mb-4\">\n        <label class=\"block text-gray-700 font-bold mb-2\" for=\"personnes\">\n          Nombre de personnes :\n        </label>\n        <input v-model=\"personnes\"\n          class=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n          id=\"personnes\" type=\"number\" placeholder=\"Entrez le nombre de personnes\" required />\n      </div>\n      <div class=\"flex justify-center\">\n        <button type=\"submit\"\n          class=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline\">\n          Réserver\n        </button>\n      </div>\n    </form>\n  </div>\n</template>\n  \n<script>\nimport { db } from '@/firebase';\nimport { collection, addDoc } from 'firebase/firestore';\nimport axios from 'axios';\n\nexport default {\n  data() {\n    return {\n      nom: '',\n      numero: '',\n      heure: '',\n      personnes: '',\n    };\n  },\n  methods: {\n    submitReservation() {\n      addDoc(collection(db, 'reservations'), {\n        nom: this.nom,\n        numero: this.numero,\n        heure: this.heure,\n        personnes: this.personnes,\n      })\n        .then((docRef) => {\n          // Succès de l'enregistrement, récupérez l'ID du document ajouté\n          const reservationId = docRef.id;\n\n          // Envoi du message texte à l'aide de Firebase Cloud Messaging\n          const message = `Nouvelle réservation - ID: ${reservationId}, Nom: ${this.nom}, Heure: ${this.heure}, Personnes: ${this.personnes}`;\n          this.sendSmsMessage('+33671783492', message); // Remplacez '+33671783492' par le numéro de téléphone du destinataire\n\n          // Réinitialisation des valeurs du formulaire\n          this.nom = '';\n          this.numero = '';\n          this.heure = '';\n          this.personnes = '';\n\n          console.log('Réservation enregistrée avec succès dans Firestore!');\n        })\n        .catch((error) => {\n          console.error('Erreur lors de l\\'enregistrement de la réservation:', error);\n        });\n    },\n    sendSmsMessage(phoneNumber, message) {\n      const serverKey = 'AAAAUTx6cRc:APA91bFEdArfClBrNz8ALQe6XFamZ8xaZiVzwoJJ3YYLv9pCMUKQ81odWF3GKvhuJTQBwTO3m_Wwit0ACdLEPiy7SzNOH9kMkLzjbqj3OuHyDJrKuJmy4h-6G2e7CrcGf5RBzqfD_N7T'; // Remplacez par votre clé de serveur FCM\n\n      const requestData = {\n        message: {\n          token: phoneNumber,\n          notification: {\n            body: message,\n            title: 'Nouvelle réservation',\n          },\n          data: {\n            phone_number: phoneNumber,\n            message: message,\n          },\n        },\n      };\n\n      axios\n        .post('https://fcm.googleapis.com/fcm/send', requestData, {\n          headers: {\n            Authorization: `Bearer ${serverKey}`,\n            'Content-Type': 'application/json',\n          },\n        })\n        .then((response) => {\n          console.log('Message sent successfully:', response.data);\n        })\n        .catch((error) => {\n          console.error('Failed to send message:', error);\n        });\n    },\n  },\n};\n</script>"],"mappings":"AAgDA,SAASA,EAAC,QAAS,YAAY;AAC/B,SAASC,UAAU,EAAEC,MAAK,QAAS,oBAAoB;AACvD,OAAOC,KAAI,MAAO,OAAO;AAEzB,eAAe;EACbC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,GAAG,EAAE,EAAE;MACPC,MAAM,EAAE,EAAE;MACVC,KAAK,EAAE,EAAE;MACTC,SAAS,EAAE;IACb,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACPC,iBAAiBA,CAAA,EAAG;MAClBR,MAAM,CAACD,UAAU,CAACD,EAAE,EAAE,cAAc,CAAC,EAAE;QACrCK,GAAG,EAAE,IAAI,CAACA,GAAG;QACbC,MAAM,EAAE,IAAI,CAACA,MAAM;QACnBC,KAAK,EAAE,IAAI,CAACA,KAAK;QACjBC,SAAS,EAAE,IAAI,CAACA;MAClB,CAAC,EACEG,IAAI,CAAEC,MAAM,IAAK;QAChB;QACA,MAAMC,aAAY,GAAID,MAAM,CAACE,EAAE;;QAE/B;QACA,MAAMC,OAAM,GAAK,8BAA6BF,aAAc,UAAS,IAAI,CAACR,GAAI,YAAW,IAAI,CAACE,KAAM,gBAAe,IAAI,CAACC,SAAU,EAAC;QACnI,IAAI,CAACQ,cAAc,CAAC,cAAc,EAAED,OAAO,CAAC,EAAE;;QAE9C;QACA,IAAI,CAACV,GAAE,GAAI,EAAE;QACb,IAAI,CAACC,MAAK,GAAI,EAAE;QAChB,IAAI,CAACC,KAAI,GAAI,EAAE;QACf,IAAI,CAACC,SAAQ,GAAI,EAAE;QAEnBS,OAAO,CAACC,GAAG,CAAC,qDAAqD,CAAC;MACpE,CAAC,EACAC,KAAK,CAAEC,KAAK,IAAK;QAChBH,OAAO,CAACG,KAAK,CAAC,qDAAqD,EAAEA,KAAK,CAAC;MAC7E,CAAC,CAAC;IACN,CAAC;IACDJ,cAAcA,CAACK,WAAW,EAAEN,OAAO,EAAE;MACnC,MAAMO,SAAQ,GAAI,0JAA0J,EAAE;;MAE9K,MAAMC,WAAU,GAAI;QAClBR,OAAO,EAAE;UACPS,KAAK,EAAEH,WAAW;UAClBI,YAAY,EAAE;YACZC,IAAI,EAAEX,OAAO;YACbY,KAAK,EAAE;UACT,CAAC;UACDvB,IAAI,EAAE;YACJwB,YAAY,EAAEP,WAAW;YACzBN,OAAO,EAAEA;UACX;QACF;MACF,CAAC;MAEDZ,KAAI,CACD0B,IAAI,CAAC,qCAAqC,EAAEN,WAAW,EAAE;QACxDO,OAAO,EAAE;UACPC,aAAa,EAAG,UAAST,SAAU,EAAC;UACpC,cAAc,EAAE;QAClB;MACF,CAAC,EACAX,IAAI,CAAEqB,QAAQ,IAAK;QAClBf,OAAO,CAACC,GAAG,CAAC,4BAA4B,EAAEc,QAAQ,CAAC5B,IAAI,CAAC;MAC1D,CAAC,EACAe,KAAK,CAAEC,KAAK,IAAK;QAChBH,OAAO,CAACG,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;MACjD,CAAC,CAAC;IACN;EACF;AACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}